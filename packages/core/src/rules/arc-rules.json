{
  "$schema": "./rules-schema.json",
  "name": "Arc Blockchain Security Rules",
  "version": "1.0.0",
  "description": "Security rules specific to the Arc blockchain ecosystem",
  "rules": [
    {
      "id": "ARC001",
      "name": "Using block.prevrandao",
      "severity": "critical",
      "category": "randomness",
      "description": "block.prevrandao is always 0 on Arc - do not use for randomness",
      "patterns": ["block\\.prevrandao", "block\\.difficulty"],
      "cwe": "CWE-330",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Use Chainlink VRF or another verifiable randomness source"
    },
    {
      "id": "ARC002",
      "name": "Hardcoded 6 Decimal Assumption",
      "severity": "critical",
      "category": "decimals",
      "description": "Arc native USDC uses 18 decimals, ERC-20 interface uses 6. Mixing causes loss of funds.",
      "patterns": ["10\\s*\\*\\*\\s*6", "1000000", "1e6"],
      "cwe": "CWE-682",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Use decimals() to get correct precision, or explicitly handle both interfaces"
    },
    {
      "id": "ARC003",
      "name": "Strict Timestamp Comparison",
      "severity": "high",
      "category": "timing",
      "description": "Multiple blocks can share same timestamp on Arc - strict comparisons may fail",
      "patterns": ["block\\.timestamp\\s*==", "block\\.timestamp\\s*!=", "require\\s*\\(\\s*block\\.timestamp\\s*>"],
      "cwe": "CWE-367",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Use >= or <= instead of strict equality for timestamp checks"
    },
    {
      "id": "ARC004",
      "name": "Unnecessary Confirmation Waits",
      "severity": "low",
      "category": "finality",
      "description": "Arc has instant deterministic finality - no need to wait for confirmations",
      "patterns": ["block\\.number\\s*>\\s*\\w+\\s*\\+\\s*\\d+", "confirmations", "waitForConfirmation"],
      "cwe": null,
      "enabled": true,
      "arcSpecific": true,
      "fix": "Arc transactions are final immediately - single confirmation is sufficient"
    },
    {
      "id": "ARC005",
      "name": "SELFDESTRUCT in Constructor",
      "severity": "critical",
      "category": "deployment",
      "description": "SELFDESTRUCT during deployment reverts on Arc if sending value to self",
      "patterns": ["constructor[^}]*selfdestruct", "constructor[^}]*suicide"],
      "cwe": "CWE-670",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Avoid selfdestruct in constructors, or ensure no value is sent to self"
    },
    {
      "id": "ARC006",
      "name": "Missing USDC Blocklist Handling",
      "severity": "medium",
      "category": "compliance",
      "description": "Arc enforces USDC blocklists - transfers to/from blocklisted addresses revert",
      "patterns": ["transfer\\(", "transferFrom\\("],
      "cwe": "CWE-754",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Implement try-catch for USDC transfers to handle blocklist reverts gracefully"
    },
    {
      "id": "ARC007",
      "name": "Mixed Decimal Interface Usage",
      "severity": "high",
      "category": "decimals",
      "description": "Mixing native (18 decimals) and ERC-20 (6 decimals) USDC interfaces",
      "patterns": ["balanceOf.*msg\\.value", "transfer.*10\\*\\*18.*10\\*\\*6"],
      "cwe": "CWE-682",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Be consistent with decimal handling - native balance is 18, ERC-20 is 6"
    },
    {
      "id": "ARC008",
      "name": "Gas Price Assumption",
      "severity": "medium",
      "category": "gas",
      "description": "Arc has different gas mechanics - hardcoded gas prices may fail",
      "patterns": ["gasPrice", "tx\\.gasprice", "gasleft\\(\\)\\s*<"],
      "cwe": "CWE-400",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Use dynamic gas estimation or Arc-specific gas handling"
    },
    {
      "id": "ARC009",
      "name": "Cross-Chain Bridge Vulnerability",
      "severity": "critical",
      "category": "bridge",
      "description": "Bridge contracts must validate source chain and message authenticity",
      "patterns": ["bridgeFrom", "crossChain", "layerZero", "wormhole", "chainId"],
      "cwe": "CWE-345",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Validate chainId, verify message signatures, implement replay protection"
    },
    {
      "id": "ARC010",
      "name": "Validator Set Dependency",
      "severity": "high",
      "category": "consensus",
      "description": "Logic dependent on validator set may behave differently on Arc",
      "patterns": ["coinbase", "block\\.coinbase", "validator"],
      "cwe": "CWE-362",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Don't rely on specific validator behavior or coinbase address"
    },
    {
      "id": "ARC011",
      "name": "Native Token Handling",
      "severity": "high",
      "category": "token",
      "description": "Arc native token (USDC) differs from ETH - ensure correct handling",
      "patterns": ["msg\\.value", "payable", "\\.value\\("],
      "cwe": "CWE-682",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Verify native token assumptions, handle USDC specifics"
    },
    {
      "id": "ARC012",
      "name": "Sequencer Dependency",
      "severity": "medium",
      "category": "infrastructure",
      "description": "Logic dependent on sequencer ordering may be exploited",
      "patterns": ["block\\.number", "getBlockNumber", "latestBlock"],
      "cwe": "CWE-362",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Don't assume specific block ordering, implement MEV protection"
    },
    {
      "id": "ARC013",
      "name": "Precompile Usage",
      "severity": "medium",
      "category": "compatibility",
      "description": "Some EVM precompiles may behave differently or not exist on Arc",
      "patterns": ["ecrecover", "sha256", "ripemd160", "modexp", "ecAdd", "ecMul", "ecPairing"],
      "cwe": "CWE-573",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Test precompile behavior on Arc testnet before mainnet deployment"
    },
    {
      "id": "ARC014",
      "name": "L2 Specific Opcodes",
      "severity": "high",
      "category": "compatibility",
      "description": "Some opcodes behave differently on L2s like Arc",
      "patterns": ["PUSH0", "BASEFEE", "SELFBALANCE", "CHAINID"],
      "cwe": "CWE-573",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Verify opcode compatibility with Arc's execution environment"
    },
    {
      "id": "ARC015",
      "name": "Withdrawal Delay Handling",
      "severity": "medium",
      "category": "bridge",
      "description": "L2 to L1 withdrawals have delay periods that must be handled",
      "patterns": ["withdraw", "exitL2", "finalizeWithdrawal"],
      "cwe": "CWE-367",
      "enabled": true,
      "arcSpecific": true,
      "fix": "Implement proper withdrawal delay handling and user notifications"
    }
  ]
}
